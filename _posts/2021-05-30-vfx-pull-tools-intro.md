---
title: 【特别企划】我们在VFX Pull的时候能干点啥
author: 张来吃
date: 2021-05-30 20:00:00 +0800
categories: [达芬奇jio本系列]
tags: [python, 达芬奇]
math: true
mermaid: true
---

> 本篇献给我们的好伙伴调色师飞仔，至于为什么，请读完全文

* * *
  

> 如果觉得有用

> 千万记得点击右上角 [ ··· ] 分享到你的朋友圈

  

* * *

  

如果你还记得上面这两行，那说明已经是小黄灯的老粉了。

  

在小黄灯不断更新的这几年，小编也在不断更新自己的工作流程，不过一直以来有一个看似简单但又复杂的问题在困扰作者所在的DI部门，那就是VFX Pull。

  

# **VFX Pull是啥**

  

简而言之，**出素材**  

你要问怎么素材，一个基础的概念，**原进原出**。当然不是说要你拷贝这么简单，yjyc表达的重点在于，尽量少地对画面进行影响，**同时发挥DI该有的能力**，完成对原始素材的加工，为VFX部门提供其所需的各个镜头。

  

此时，通常我们会关心以下几个方面：  

  

*   输出的画面格式/编码
    
      
    

这一步通常不会有过多的疑问。对于VFX部门而言没有太大的必要去处理原始素材（RAW档），关心他们原本是什么样子。处理这些RAW档正是DI通过使用达芬奇最擅长的能力，这中间毕竟会涉及到**RAW应该长什么样子**，这是DI理应负责的事情，因此我们首先只需与VFX的小伙伴确认好他们需要什么编码，例如最为常见的OpenEXR；  
  

*   画面尺寸的处理
    
      
    

VFX天生对画面尺寸更为敏感，RAW档动不动就拍8k 12k的时候对于VFX而言只能😒一番。那对画面尺寸做下变换的任务交给DI进行是一个很自然的事。例如最为常规的2k等宽计。

  

*   画面内容的处理
    

敲黑板了。这里指的是，两个灵魂拷问：画面要不要带上PTZR；画面要不要带上变速。道理我们都懂，这些操作应该交由VFX来处理，一旦DI对画面进行了这些调整，开弓是没有回头箭的。在相对严格的制作流程下，也不应当产生这样的需求。然而实践中如果有这样的情况出现的话，那只能说请慎重考虑。  

  

*   画面色彩的处理
    
      
    

在VFX制作内容不太复杂的前提下，画面色彩无论“Log”还是“709”，交给VFX然后以“原本的色彩”回到DI，基本上不会有特别大的问题。可一旦制作体量庞大起来，甚至需要对前后镜头严格匹配等等时候，我们就需要考虑是不是应该对画面进行“预调色”，更准确地说是“neutral grade”。

  

*   交付规则
    
      
    

即以一个特定的文件夹层级结构，一个统一规范的方式整理好这些镜头，交给VFX部门。具体实践起来，主要在于文件夹层级如何划分更为合理，这中间还会涉及到*镜头号的存在*这个问题。每个镜头如果只是一波输出完拿个硬盘拷走，那就不会有今天这篇文章了。  

  

  

  

# **准备进入正题**

  

对于交付这个环节来说一个很难忽略的步骤是，搞清楚每个镜头谁是谁。  

  

对于VFX而言，每个镜头的识别与DI不同的习惯是，更关心它的**镜头号**，以及其帧数。对于一个合理的Turnover流程而言，是需要上游环节（通常会是剪辑/视效剪辑）整理好输出所需时间线，收拾好VFX所需镜头，并去掉所有效果，包括转场、变速，更细致一些则需要预留所需handle，输出EDL和参考小样，交给DI。  

  

随便问两句，这些镜头如果在VFX体系下已经没了原始的镜头文件名（例如A001C001_210501_RSX1），如有任何疑问，需要DI进行必要的排查时，DI怎么知道它是谁？镜头做好了给回DI，如果没有管理对应的原始RAW档，如有任何疑问，DI怎么知道它是谁？

  

那即便是VFX的小伙伴说，_没关系我们不麻烦你们在交付的文件中体现镜头号_，DI也有足够的理由，以镜头号为依据，管理好给出去的Plate。  

  

所以在交付时，将镜头号体现为文件/文件夹名称，就是一种常见的方法。  

  

# **那么镜头号是从哪儿来呢**  

  

目光看向上游，通常DI的上游环节是有足够的理由和条件，来对每个VFX镜头做管理的。也就是说，至少在DI开工前，镜头号这个**名字**其实已经起好了，而通常会在交给下游部门的参考小样中会烧到画面上。  

  

那么懒惰如我，既然已经有人给每个镜头命过名了，我们是不是可以直接把这些信息提取出来就行。

  

# **好家伙 今天的正文终于展开了**  

  

在时间线中为每个赋予特定名称这个事，我们曾经历了三个阶段。

  

# **第一阶段 - 手工业时期**

  

开始之前，我们需要了解达芬奇的一个特点：

![640-1](https://raw.githubusercontent.com/laciechang/img/master/spotlight_img/640-1.png)

我们很容易遇到时间线两条片段其实对应了媒体池中同一个素材，但需要分别需要起两个不同名字的情况。如果使用metadata中各种丰富的字段来填写这些名字，就不能实现各自分别独立。

  

当时曾有人想到生成**子片段的方式**来解决这个问题，代价就是需要在遇到这种情况时，将片段拖拽回媒体池中一个新的Bin，然后再把这个子片段拖回时间线，即可使其独立出来。  

  

你问我名字怎么写进去，那就是手写啊……显然这就是一个非常痛苦的过程，问谁都会选择拒绝（如果可以的话）。顺便，这样的手工操作还会带来不必要的意外出错的可能性。

  

# **第二阶段 - 半自动时期**

  

那么之前已经说过了，我们完全可以借助上游环节已经起过名字这个结果

  

当时我们的实践方案自然先得是联系上他们，拜托以任何他们方便的方式来将这些编号导出（也不要太麻烦人家咯），然后再自行想尽各种办法把这些名称提取为可编辑的文本。  

  

那怎么把这些名字塞进时间线每个片段里，并且还可以保持各自独立呢？从达芬奇12.5到14之后，经过各种脑洞大开的尝试，我们终于发现EDL里头的 `EDL Clip Name` 可以携带进时间线，并且能保持其独立存在，以及可以通过百分号也就是 %EDL Clip Name ，将其烧录，以及最关键的作为输出路径。

  

> 虽然不敢说这个方法是原创，或唯一一个“发现者”；但至少可以说是最早的一批应用这个特性的小di了。

  

随后我们想到了Excel。Excel是如此强大以至于可以自己写VBA来搞定EDL的导入与导出。  

  

![640](https://raw.githubusercontent.com/laciechang/img/master/spotlight_img/640.png)

  

我们把时间线整理检查ok之后，导出EDL扔进Excel这个模板，粘贴镜头号并简单核对，点击导出，再把EDL扔进达芬奇就完事了。

  

# **第三阶段 - 全自动时代**

  

其实到这个时候已经很方便了，命名镜头号这个事情已经不再成为一个**负担**。  

  

但仔细观察还是会发现这个操作来来回回进进出出好几步，提取镜头号这个过程全靠大家的聪明才智，并且中间会有很多可能会因为操作问题导致出错的情况；以及楼上我们提到的，如果VFX因为各种缘故，需要DI输出带位移缩放变速的镜头时，用EDL就凉了。  

  

辣么有什么更厉害的解决方案呢  

  
![WechatIMG4818](https://raw.githubusercontent.com/laciechang/img/master/spotlight_img/WechatIMG4818.jpeg)
  

所以现在就出现了*终*极*大*招*（至少目前为止）

  

只需上游给到 `xml ( pr / fcp7 ) / avid txt / fcpxml` （甚至可以不断扩展其功能），其中携带了以镜头号为内容的字幕或别的名字，且与所属镜头IO点能尽可能准确对应（手滑放歪了不准确都行），也就是说，**导出输出参考小样的这个时间线给我们**，我们就能用这个工具，把镜头号提取出来塞进时间线中现成的片段上，如果有哪个镜头不对劲就会添加片段颜色以示区分。

  

不用来回导入导出，不用为了这事进行任何额外的编辑操作，只要确保conform一切顺利，点几下就可以把镜头号写上去。  

  

毕竟省下来的时间就是为了让大家进行人工检查核对，确保无误后即可按任何方便的方式进行输出。

  

# **就这？**

  

对啊，这就是我想与大家分享的，我们与“以镜头号命名”这个小事纠结几年的一个过程…如果你都读到这里了，说不定也是有诸多故事想要分享。  

  

差点忘了，上述终极工具的主要作者并不是我，而是我们的好伙伴 **#调色师飞哥**，我只在其中贡献了为数不多的代码而已。

  

所以工具的分享…自然就么有了，相信有研发能力团队自然可以为DI的小伙伴们解放更多生产力，用有限的工作时间，做更多应当做的事。  

  

完